1. 目的・背景
項目	内容
課題	Mac ↔ Android 間で USB 有線転送が不安定／不可。
解決策	Android 端末側でローカルネットワーク向けファイル受信サーバを起動し、Mac など他デバイスから HTTP 経由でアップロードできるようにする。
ゴール	オフラインでも 数 GB クラスのファイル をストレスなくやり取り可能に。ケーブル不要・外部クラウド依存なし。

2. 用語集
用語	定義
ホスト端末	サーバを起動する Android 端末。
クライアント	ブラウザまたは CLI でファイルをアップロードする側。
セッション	ホストがサーバを起動している間の一連のアップロード受付期間。

3. スコープ
3.1 インスコープ
ファイル受信

HTTP/HTTPS POST で単発ファイル or マルチパートアップロード

進捗表示

Android 側：アップロード一覧 + プログレスバー

クライアント側：標準的なブラウザ UI（フォーム + 進捗）

転送完了後の保存

端末内ストレージ（アプリ固有領域 or /storage/emulated/0/Download/<AppName>/）

ネットワーク自動検出

ホストが表示する QR コード or mDNS（_filedrop._tcp.local）で URL 共有

同時接続：最低 3 並列アップロードを許可

整合性確認：SHA-256 チェックサム検証 (オプション)

3.2 アウトオブスコープ
自動双方向同期（リアルタイムミラーリング）

インターネット越し転送

フォルダごとの差分同期（現フェーズでは単発ファイルのみ）

4. 制約
区分	内容
技術スタック	Tauri (Rust, wry) + Android target (arm64-v8a)
ネットワーク	ローカル Wi-Fi / USB テザリング想定、IPv4 必須
ストレージ	外部ストレージ権限（MANAGE_EXTERNAL_STORAGE は避ける方針）
セキュリティ	デフォルトはローカルネット内のみアクセス可。オプションでパスワード or トークン認証。
ライセンス	MIT 予定

5. 利用シナリオ（ユーザーストーリー）
ID	ユーザー	目的	条件	受け入れ基準
US1	Mac 利用者	写真 500 MB を Android へ送る	同一 LAN 内	ブラウザで URL へアクセス→ファイル選択→100% → 「完了」表示 & Android 側にファイル生成を確認
US2	複数クライアント	同時に資料を送付	3 クライアント並列	各進捗が独立し、3 件とも整合性 OK
US3	Android 利用者	転送結果を確認	転送後	アプリ UI でファイル名・サイズ・日時が確認でき、タップで共有メニューが開く

6. 機能要件
FR-ID	要件	優先度
FR-01	ホスト起動時に HTTP サーバを立て、ポート番号を UI に表示する。	★★★
FR-02	/upload エンドポイントで最大 4 GiB のファイル受信を許可。	★★★
FR-03	マルチパートフォームの file フィールドを保存し、同名重複時は自動リネーム。	★★☆
FR-04	転送進捗を SSE もしくは WebSocket でフロントに通知。	★★☆
FR-05	転送完了後に SHA-256 を計算し、クライアントが送信した値と一致を確認。	★★☆
FR-06	mDNS と QR コード生成で接続 URL を共有。	★★☆
FR-07	設定画面で保存先ディレクトリとポートを変更可能。	★★☆
FR-08	オプションで単純な Basic 認証（ユーザ/パス）を有効化。	★☆☆

7. 非機能要件
NFR-ID	要件	指標
NFR-01	パフォーマンス	1 GB ファイルを 150 Mbps 以上の実転送速度で処理（Wi-Fi 6 環境）
NFR-02	リソース使用	CPU 使用率 1 コア未満、RAM 150 MB 未満（アップロード待機時）
NFR-03	信頼性	連続 24 時間セッションでクラッシュゼロ、ファイル欠損ゼロ
NFR-04	起動時間	アプリ起動からサーバ待受開始まで 3 秒以内
NFR-05	ユーザビリティ	3 タップ以内で「サーバ開始」→「URL/Qr 表示」まで操作可能

8. 画面・UI モック（概要）
ホーム画面

「サーバ開始」ボタン

起動すると URL 表示 + QR コード

転送履歴リスト（縦スクロール）

設定画面

保存先ディレクトリピッカー

ポート番号入力

認証 on/off + パスワード設定

起動時自動サーバ開始 on/off

9. API インターフェイス（暫定）
メソッド	パス	内容	認証
POST	/upload	multipart/form-data、キー file	Basic 認証(任意)
GET	/healthz	Liveness probe	なし
GET	/events	SSE 進捗配信	Basic 認証(任意)

10. 受け入れテスト項目
単一ファイル転送：1 GB ファイルをアップロードし、ハッシュ一致を確認。

並列アップロード：3 クライアント同時送信し、全件成功すること。

認証有効時：未認証アクセスが 401。正しい認証で転送成功。

ネットワーク遮断復旧：転送中に Wi-Fi 切断→再接続時は適切にエラーが返る。

保存先変更：設定変更後、新パスにファイルが生成される。

11. ロードマップ案
フェーズ	目標	期間
POC	Rust + Hyper で 1 ファイル受信 → 保存	1 週
α版	Tauri UI 組み込み、単一転送 UI	+1 週
β版	並列転送・QR/mDNS・設定画面	+2 週
リリース	認証・チェックサム・Google Play 内部テスト	+2 週